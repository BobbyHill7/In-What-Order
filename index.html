<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>In What Order? â€“ Raw Manta Ray</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Montserrat:wght@500;700&display=swap" rel="stylesheet">

<style>
:root {
  --bg:#0e1a22;
  --panel:#132733;
  --accent:#f2b705;
  --green:#2ecc71;
  --yellow:#f1c40f;
  --red:#e74c3c;
}

* { box-sizing:border-box; }

body {
  margin:0;
  background:radial-gradient(circle at top,#1c3b4a,var(--bg));
  color:#fff;
  font-family:'Montserrat',sans-serif;
}

header {
  padding:10px;
  text-align:center;
  background:linear-gradient(135deg,#1fa2ff,var(--accent));
  color:#000;
}

header h1 {
  font-family:'Orbitron',sans-serif;
  font-size:1.5rem;
  margin:0;
}

header h2 {
  margin:2px 0 0;
  font-size:0.95rem;
}

.main {
  display:grid;
  grid-template-columns:230px 1fr 140px;
  gap:10px;
  max-width:1200px;
  margin:auto;
  padding:10px;
}

.instructions {
  background:var(--panel);
  padding:10px;
  border-radius:10px;
  font-size:0.8rem;
  line-height:1.35;
}

.board {
  background:var(--panel);
  padding:10px;
  border-radius:12px;
}

.board h3 {
  margin:0 0 8px;
  font-size:0.95rem;
  text-align:center;
  font-weight:700;
}

.timer {
  position:sticky;
  top:10px;
  background:#000;
  font-family:'Orbitron',sans-serif;
  font-size:2.6rem;
  text-align:center;
  padding:10px;
  border-radius:12px;
}

.list { display:none; }

.item {
  height:56px;
  display:flex;
  align-items:center;
  gap:8px;
  padding:4px 8px;
  margin:4px 0;
  background:#0f2029;
  border-radius:8px;
  border:3px solid transparent;
  cursor:grab;
  font-size:0.82rem;
}

.item img {
  width:40px;
  height:40px;
  object-fit:contain;
}

.correct { border-color:var(--green); box-shadow:0 0 6px var(--green); }
.partial { border-color:var(--yellow); box-shadow:0 0 6px var(--yellow); }
.wrong   { border-color:var(--red);   box-shadow:0 0 6px var(--red); }

button {
  font-family:'Orbitron',sans-serif;
  padding:6px 16px;
  border:none;
  border-radius:20px;
  cursor:pointer;
  background:var(--accent);
  margin-top:8px;
  font-size:0.85rem;
}

.score {
  margin-top:8px;
  font-family:'Orbitron',sans-serif;
  font-size:1.2rem;
  display:none;
}

/* CONFETTI */
.confetti {
  position:fixed;
  top:-12px;
  width:8px;
  height:8px;
  opacity:0.9;
  pointer-events:none;
  animation:confetti-fall linear forwards;
}

@keyframes confetti-fall {
  to {
    transform:translateY(110vh) rotate(360deg);
    opacity:0;
  }
}
</style>
</head>

<body>

<header>
  <h1>In What Order?</h1>
  <h2>Raw Manta Ray</h2>
</header>

<div class="main">

<div class="instructions">
<strong>How to Play</strong>
<ul>
<li>Order updates from <b>earliest â†’ latest</b></li>
<li>ðŸŸ¢ Exact position</li>
<li>ðŸŸ¡ Correct relative order</li>
<li>ðŸ”´ Incorrect</li>
</ul>
</div>

<div class="board">
  <h3>In what order of content updates did more sources for raw manta rays get added into the game?</h3>

  <div id="list" class="list"></div>

  <button id="startBtn">START</button>
  <button id="submitBtn" style="display:none;">SUBMIT</button>

  <div class="score" id="score"></div>
</div>

<div class="timer" id="timer">48</div>

</div>

<script>
const MAX_TIME = 48;
const MAX_SCORE = 100;

const correctOrder = [
  "Fossil Island","Brimstone Chest","The Mimic","Larranâ€™s Chest",
  "Tempoross","Tombs of Amascut","The Leviathan","Killing a Manta Ray"
];

const dates = {
  "Fossil Island":"September 2017",
  "Brimstone Chest":"February 2019",
  "The Mimic":"April 2019",
  "Larranâ€™s Chest":"June 2019",
  "Tempoross":"March 2021",
  "Tombs of Amascut":"August 2022",
  "The Leviathan":"July / August 2023",
  "Killing a Manta Ray":"November 2025"
};

const data = [
  ["Fossil Island","https://oldschool.runescape.wiki/images/Fossil_Island_logo.png?f8132"],
  ["Brimstone Chest","https://oldschool.runescape.wiki/images/Brimstone_chest.png?23463"],
  ["The Mimic","https://oldschool.runescape.wiki/images/thumb/The_Mimic.png/1024px-The_Mimic.png?b45f4"],
  ["Larranâ€™s Chest","https://oldschool.runescape.wiki/images/Larran%27s_big_chest.png?eb3ea"],
  ["Tempoross","https://oldschool.runescape.wiki/images/Tempoross.png?12042"],
  ["Tombs of Amascut","https://oldschool.runescape.wiki/images/Tombs_of_Amascut.png?f9992"],
  ["The Leviathan","https://oldschool.runescape.wiki/images/The_Leviathan.png?d588a"],
  ["Killing a Manta Ray","https://oldschool.runescape.wiki/images/Manta_ray_%28Sailing%29.png?80b30"]
];

const list = document.getElementById("list");
const timerEl = document.getElementById("timer");
const scoreEl = document.getElementById("score");
const startBtn = document.getElementById("startBtn");
const submitBtn = document.getElementById("submitBtn");

let time = MAX_TIME;
let interval;
let dragged;
let gameOver = false;
let confettiPlayed = false;
let datesShown = false;

function shuffle(arr){ return [...arr].sort(()=>Math.random()-0.5); }

startBtn.onclick = () => {
  shuffle(data).forEach(d=>{
    const el=document.createElement("div");
    el.className="item";
    el.draggable=true;
    el.dataset.name=d[0];
    el.innerHTML=`<img src="${d[1]}"><div>${d[0]}</div>`;
    list.appendChild(el);
  });

  list.style.display="block";
  startBtn.style.display="none";
  submitBtn.style.display="inline-block";

  interval=setInterval(()=>{
    if(gameOver) return;
    time--;
    timerEl.textContent=time;
    if(time<=0) endGame(false);
  },1000);
};

list.addEventListener("dragstart",e=>dragged=e.target);
list.addEventListener("dragover",e=>{
  e.preventDefault();
  if(gameOver) return;
  const t=e.target.closest(".item");
  if(!t||t===dragged) return;
  const r=t.getBoundingClientRect();
  list.insertBefore(dragged, e.clientY>r.top+r.height/2 ? t.nextSibling : t);
});

submitBtn.onclick = () => {
  if(gameOver) return;

  const items=[...list.children].map(el=>el.dataset.name);

  let correctPairs=0, totalPairs=0;

  for(let i=0;i<correctOrder.length;i++){
    for(let j=i+1;j<correctOrder.length;j++){
      totalPairs++;
      if(items.indexOf(correctOrder[i]) < items.indexOf(correctOrder[j])) {
        correctPairs++;
      }
    }
  }

  [...list.children].forEach((el,i)=>{
    el.classList.remove("correct","partial","wrong");
    const name = el.dataset.name;
    const correctIdx = correctOrder.indexOf(name);
  
    if (correctIdx === i) {
      el.classList.add("correct");
      return;
    }
  
    let okPrev = true, okNext = true;
  
    if (i > 0) {
      const prevName = list.children[i-1].dataset.name;
      okPrev = correctOrder.indexOf(prevName) < correctIdx;
    }
  
    if (i < list.children.length - 1) {
      const nextName = list.children[i+1].dataset.name;
      okNext = correctIdx < correctOrder.indexOf(nextName);
    }
  
    el.classList.add(okPrev && okNext ? "partial" : "wrong");
  });
  
  if(correctPairs===totalPairs){
    endGame(true);
  }
};

function endGame(perfect){
  gameOver=true;
  clearInterval(interval);

  const items=[...list.children];
  let correctish=0;

  items.forEach(el=>{
    if(el.classList.contains("correct")||el.classList.contains("partial")){
      correctish++;
    }
    el.draggable=false;
  });

  if(!datesShown){
    datesShown=true;
    items.forEach(el=>{
      el.children[1].textContent += ` â€” ${dates[el.dataset.name]}`;
    });
  }

  if(perfect) confetti();

  const timeMax = Math.max(0, MAX_SCORE - (MAX_TIME - time));
  const score = Math.floor(timeMax * (correctish / items.length));

  scoreEl.style.display="block";
  scoreEl.textContent=`Score: ${score} / ${MAX_SCORE}`;
}

function confetti(){
  if(confettiPlayed) return;
  confettiPlayed=true;

  for(let i=0;i<120;i++){
    const c=document.createElement("div");
    c.className="confetti";
    c.style.left=Math.random()*100+"vw";
    c.style.background=Math.random()>0.5?"#f2b705":"#1fa2ff";
    c.style.animationDuration=(Math.random()*1.5+2)+"s";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),3000);
  }
}
</script>

</body>
</html>
