<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>In What Order? â€“ Raw Manta Ray</title>

<style>
:root {
  --bg-dark: #1e2a3a;
  --bg-panel: #28344b;
  --yellow: #ffd700;
  --blue: #60a5fa;
  --text: #f3f4f6;
}

body {
  font-family: "Trebuchet MS", Arial, sans-serif;
  background: var(--bg-dark);
  color: var(--text);
  padding: 20px;
}

.container {
  max-width: 780px;
  margin: auto;
}

.header {
  text-align: center;
  background: linear-gradient(90deg, var(--yellow), #ffef8a);
  color: #1b1b1b;
  padding: 16px;
  border-radius: 14px;
  box-shadow: 0 6px 0 #bfa600;
  margin-bottom: 16px;
}

.header h1 {
  margin: 0;
  font-size: 2.4em;
}

.header h2 {
  margin: 6px 0 0;
  font-size: 1.2em;
}

.instructions {
  text-align: center;
  font-style: italic;
  color: #c7d2fe;
  margin-bottom: 10px;
}

.timer {
  text-align: center;
  font-size: 2em;
  font-weight: bold;
  color: var(--yellow);
  margin-bottom: 10px;
}

h3 {
  text-align: center;
  margin: 12px 0;
}

.list {
  border: 3px solid var(--yellow);
  background: var(--bg-panel);
  border-radius: 14px;
  padding: 6px 10px;
}

.item {
  display: flex;
  align-items: center;
  background: #1f293b;
  border: 2px solid #334155;
  padding: 4px 10px;
  margin: 6px 0;
  border-radius: 10px;
  cursor: grab;
  height: 52px;
  transition: border-color 0.3s, box-shadow 0.3s;
}

.item:active { cursor: grabbing; }

.item img {
  width: 36px;
  height: 36px;
  margin-right: 10px;
}

.correct {
  border-color: #22c55e;
  box-shadow: 0 0 12px #22c55e;
}

.partial {
  border-color: #facc15;
  box-shadow: 0 0 12px #facc15;
}

.wrong {
  border-color: #ef4444;
  box-shadow: 0 0 12px #ef4444;
}

button {
  width: 100%;
  margin-top: 14px;
  padding: 12px;
  border-radius: 10px;
  border: none;
  background: var(--yellow);
  color: #1b1b1b;
  font-weight: bold;
  font-size: 1.05em;
  cursor: pointer;
  box-shadow: 0 5px 0 #bfa600;
}

#result {
  margin-top: 14px;
  text-align: center;
  font-size: 1.1em;
}

.confetti {
  position: fixed;
  top: -10px;
  width: 8px;
  height: 8px;
  animation: fall 3s linear forwards;
}

@keyframes fall {
  to {
    transform: translateY(110vh) rotate(360deg);
    opacity: 0;
  }
}
</style>
</head>

<body>
<div class="container">

<div class="header">
  <h1>In What Order?</h1>
  <h2>Raw Manta Ray</h2>
</div>

<div class="instructions">
  Sort the updates from <strong>earliest to latest</strong>.  
  Incorrect submissions remove 5 seconds.
</div>

<div class="timer" id="timer">48</div>

<h3>In what order of content updates did more sources for raw manta rays get added into the game?</h3>

<div id="list" class="list"></div>

<button id="startBtn">Start Game</button>
<button id="submitBtn" disabled>Submit</button>

<div id="result"></div>

</div>

<script>
const correctOrder = [
  { name:"Fossil Island", date:"September 2017", img:"https://oldschool.runescape.wiki/images/Fossil_Island_logo.png?f8132" },
  { name:"Brimstone Chest", date:"February 2019", img:"https://oldschool.runescape.wiki/images/Brimstone_chest.png?23463" },
  { name:"The Mimic", date:"April 2019", img:"https://oldschool.runescape.wiki/images/thumb/The_Mimic.png/1024px-The_Mimic.png?b45f4" },
  { name:"Larranâ€™s Chest", date:"June 2019", img:"https://oldschool.runescape.wiki/images/Larran%27s_big_chest.png?eb3ea" },
  { name:"Tempoross", date:"March 2021", img:"https://oldschool.runescape.wiki/images/Tempoross.png?12042" },
  { name:"Tombs of Amascut", date:"August 2022", img:"https://oldschool.runescape.wiki/images/Tombs_of_Amascut.png?f9992" },
  { name:"The Leviathan", date:"July / August 2023", img:"https://oldschool.runescape.wiki/images/The_Leviathan.png?d588a" },
  { name:"Killing a Manta Ray", date:"November 2025", img:"https://oldschool.runescape.wiki/images/Manta_ray_%28Sailing%29.png?80b30" }
];

const list = document.getElementById("list");
const timerEl = document.getElementById("timer");
const result = document.getElementById("result");
const startBtn = document.getElementById("startBtn");
const submitBtn = document.getElementById("submitBtn");

let time = 48;
let timer;
let gameOver = false;
let datesShown = false;

function shuffle(arr){ return [...arr].sort(()=>Math.random()-0.5); }

function render(items){
  list.innerHTML="";
  items.forEach(i=>{
    const d=document.createElement("div");
    d.className="item";
    d.draggable=true;
    d.dataset.name=i.name;
    d.innerHTML=`<img src="${i.img}"><span>${i.name}</span>`;
    list.appendChild(d);
  });
}

startBtn.onclick=()=>{
  render(shuffle(correctOrder));
  startBtn.disabled=true;
  submitBtn.disabled=false;
  timer=setInterval(()=>{
    time--;
    timerEl.textContent=time;
    if(time<=0) endGame(false);
  },1000);
};

let dragged=null;
document.addEventListener("dragstart",e=>{
  if(e.target.classList.contains("item")) dragged=e.target;
});
document.addEventListener("dragover",e=>{
  e.preventDefault();
  const t=e.target.closest(".item");
  if(t && t!==dragged){
    const r=t.getBoundingClientRect();
    list.insertBefore(dragged, e.clientY-r.top>r.height/2 ? t.nextSibling : t);
  }
});

function endGame(won){
  clearInterval(timer);
  gameOver=true;
  [...list.children].forEach(i=>i.draggable=false);
  revealDates();
  result.innerHTML = won ? "ðŸ† Perfect! Score: 100" : "â±ï¸ Timeâ€™s up!";
}

function revealDates(){
  if(datesShown) return;
  datesShown=true;
  [...list.children].forEach(el=>{
    const d=correctOrder.find(o=>o.name===el.dataset.name);
    el.querySelector("span").textContent=`${d.name} â€” ${d.date}`;
  });
}

submitBtn.onclick=()=>{
  if(gameOver) return;
  let items=[...list.children].map(i=>i.dataset.name);
  let correct=correctOrder.map(o=>o.name);

  let inversions=0, max=0;
  for(let i=0;i<correct.length;i++){
    for(let j=i+1;j<correct.length;j++){
      max++;
      if(items.indexOf(correct[i]) < items.indexOf(correct[j])) inversions++;
    }
  }

  [...list.children].forEach((el,i)=>{
    el.classList.remove("correct","partial","wrong");
    const name=el.dataset.name;
    const idx=correct.indexOf(name);
    if(idx===i) el.classList.add("correct");
    else {
      let ok=true;
      for(let j=0;j<correct.length;j++){
        if(j===idx) continue;
        if((idx<j)!==(items.indexOf(name)<items.indexOf(correct[j]))) ok=false;
      }
      el.classList.add(ok?"partial":"wrong");
    }
  });

  if(inversions===max){
    confetti();
    endGame(true);
  } else {
    time=Math.max(0,time-5);
    timerEl.textContent=time;
  }
};

function confetti(){
  for(let i=0;i<120;i++){
    const c=document.createElement("div");
    c.className="confetti";
    c.style.left=Math.random()*100+"vw";
    c.style.background=Math.random()>0.5?"#ffd700":"#60a5fa";
    c.style.animationDuration=(Math.random()*1.5+2)+"s";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),3000);
  }
}
</script>
</body>
</html>
